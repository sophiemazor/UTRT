var jsPsychImageButtonResponse=function(n){"use strict";var g="2.1.0";const b={name:"image-button-response",version:g,parameters:{stimulus:{type:n.ParameterType.IMAGE,default:void 0},stimulus_height:{type:n.ParameterType.INT,default:null},stimulus_width:{type:n.ParameterType.INT,default:null},maintain_aspect_ratio:{type:n.ParameterType.BOOL,default:!0},choices:{type:n.ParameterType.STRING,default:void 0,array:!0},button_html:{type:n.ParameterType.FUNCTION,default:function(p,s){return`<button class="jspsych-btn">${p}</button>`}},prompt:{type:n.ParameterType.HTML_STRING,default:null},stimulus_duration:{type:n.ParameterType.INT,default:null},trial_duration:{type:n.ParameterType.INT,default:null},button_layout:{type:n.ParameterType.STRING,default:"grid"},grid_rows:{type:n.ParameterType.INT,default:1},grid_columns:{type:n.ParameterType.INT,default:null},response_ends_trial:{type:n.ParameterType.BOOL,default:!0},render_on_canvas:{type:n.ParameterType.BOOL,default:!0},enable_button_after:{type:n.ParameterType.INT,default:0}},data:{stimulus:{type:n.ParameterType.STRING},response:{type:n.ParameterType.INT},rt:{type:n.ParameterType.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}};class c{constructor(s){this.jsPsych=s}trial(s,e){const i=t=>{let a,d;return e.stimulus_height!==null?(d=e.stimulus_height,e.stimulus_width==null&&e.maintain_aspect_ratio&&(a=t.naturalWidth*(e.stimulus_height/t.naturalHeight))):d=t.naturalHeight,e.stimulus_width!==null?(a=e.stimulus_width,e.stimulus_height==null&&e.maintain_aspect_ratio&&(d=t.naturalHeight*(e.stimulus_width/t.naturalWidth))):e.stimulus_height!==null&&e.maintain_aspect_ratio||(a=t.naturalWidth),[a,d]};s.innerHTML="";let r,l;const o=e.render_on_canvas?new Image:document.createElement("img");e.render_on_canvas?(l=document.createElement("canvas"),l.style.margin="0",l.style.padding="0",r=l):r=o;const h=()=>{const[t,a]=i(o);e.render_on_canvas?(l.width=t,l.height=a,l.getContext("2d").drawImage(o,0,0,t,a)):(o.style.width=`${t}px`,o.style.height=`${a}px`)};let _=!1;o.onload=()=>{_||h()},o.src=e.stimulus,o.complete&&o.naturalWidth!==0&&(h(),_=!0),r.id="jspsych-image-button-response-stimulus",s.appendChild(r);const u=document.createElement("div");if(u.id="jspsych-image-button-response-btngroup",e.button_layout==="grid"){if(u.classList.add("jspsych-btn-group-grid"),e.grid_rows===null&&e.grid_columns===null)throw new Error("You cannot set `grid_rows` to `null` without providing a value for `grid_columns`.");const t=e.grid_columns===null?Math.ceil(e.choices.length/e.grid_rows):e.grid_columns,a=e.grid_rows===null?Math.ceil(e.choices.length/e.grid_columns):e.grid_rows;u.style.gridTemplateColumns=`repeat(${t}, 1fr)`,u.style.gridTemplateRows=`repeat(${a}, 1fr)`}else e.button_layout==="flex"&&u.classList.add("jspsych-btn-group-flex");for(const[t,a]of e.choices.entries()){u.insertAdjacentHTML("beforeend",e.button_html(a,t));const d=u.lastChild;d.dataset.choice=t.toString(),d.addEventListener("click",()=>{T(t)})}s.appendChild(u),e.prompt!==null&&s.insertAdjacentHTML("beforeend",e.prompt);var f=performance.now(),m={rt:null,button:null};const y=()=>{var t={rt:m.rt,stimulus:e.stimulus,response:m.button};this.jsPsych.finishTrial(t)};function T(t){var a=performance.now(),d=Math.round(a-f);m.button=parseInt(t),m.rt=d,r.classList.add("responded");for(const w of u.children)w.setAttribute("disabled","disabled");e.response_ends_trial&&y()}function P(){for(var t=document.querySelectorAll(".jspsych-image-button-response-button button"),a=0;a<t.length;a++)t[a].removeAttribute("disabled")}function v(){for(var t=document.querySelectorAll(".jspsych-image-button-response-button button"),a=0;a<t.length;a++)t[a].setAttribute("disabled","disabled")}e.enable_button_after>0&&(v(),this.jsPsych.pluginAPI.setTimeout(()=>{P()},e.enable_button_after)),e.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{r.style.visibility="hidden"},e.stimulus_duration),e.trial_duration!==null?this.jsPsych.pluginAPI.setTimeout(()=>{y()},e.trial_duration):e.response_ends_trial===!1&&console.warn("The experiment may be deadlocked. Try setting a trial duration or set response_ends_trial to true.")}simulate(s,e,i,r){e=="data-only"&&(r(),this.simulate_data_only(s,i)),e=="visual"&&this.simulate_visual(s,i,r)}create_simulation_data(s,e){const i={stimulus:s.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)+s.enable_button_after,response:this.jsPsych.randomization.randomInt(0,s.choices.length-1)},r=this.jsPsych.pluginAPI.mergeSimulationData(i,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(s,r),r}simulate_data_only(s,e){const i=this.create_simulation_data(s,e);this.jsPsych.finishTrial(i)}simulate_visual(s,e,i){const r=this.create_simulation_data(s,e),l=this.jsPsych.getDisplayElement();this.trial(l,s),i(),r.rt!==null&&this.jsPsych.pluginAPI.clickTarget(l.querySelector(`#jspsych-image-button-response-btngroup [data-choice="${r.response}"]`),r.rt)}}return c.info=b,c}(jsPsychModule);
//# sourceMappingURL=https://unpkg.com/@jspsych/plugin-image-button-response@2.1.0/dist/index.browser.min.js.map
